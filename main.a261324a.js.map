{"version":3,"sources":["scripts/main.js"],"names":["gameField","change","startX","startY","score","button","document","querySelector","startMessages","loseMessages","winMessages","elementScore","cells","querySelectorAll","swipeArea","fillGameField","board","count","stopGame","cellListNum","forEach","element","i","item","j","textContent","className","removeEventListener","keyPress","classList","remove","gerRandom小oordinate","Math","floor","random","addCell","row","col","stepX","reverse","filter","el","innerText","length","toString","stepY","rotatedBoard","map","nextCell","setTimeout","e","preventDefault","code","touchEnd","touchEndX","deltaX","changedTouches","clientX","deltaY","clientY","abs","addEventListener","contains","hidden","add","touches"],"mappings":"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","file":"main.a261324a.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\n\nlet gameField;\nlet score = 0;\nlet change;\nconst button = document.querySelector('button');\nconst startMessages = document.querySelector('.message-start');\nconst loseMessages = document.querySelector('.message-lose');\nconst winMessages = document.querySelector('.message-win');\nconst elementScore = document.querySelector('.game-score');\nconst cells = document.querySelectorAll('.field-cell');\n\nconst swipeArea = document.querySelector('.game-field');\nlet startX;\nlet startY;\n\nfunction fillGameField(board) {\n  let count = 0;\n  let stopGame = true;\n  let cellListNum = 0;\n\n  board.forEach((element, i) => {\n    element.forEach((item, j) => {\n      if (item) {\n        cells[cellListNum].textContent = item;\n        cells[cellListNum].className = `field-cell field-cell--${item}`;\n\n        if (item === 2048) {\n          document.removeEventListener('keydown', keyPress);\n          winMessages.classList.remove('hidden');\n        }\n\n        count++;\n\n        if (item === board[i][j + 1] || (i < 3 && item === board[i + 1][j])) {\n          stopGame = false;\n        }\n      } else {\n        cells[cellListNum].textContent = '';\n        cells[cellListNum].className = 'field-cell';\n      }\n      cellListNum++;\n    });\n  });\n\n  if (count === 16 && stopGame === true) {\n    document.removeEventListener('keydown', keyPress);\n    loseMessages.classList.remove('hidden');\n  }\n}\n\nfunction gerRandom小oordinate() {\n  return Math.floor(Math.random() * 4);\n}\n\nfunction addCell(board) {\n  let row, col;\n\n  do {\n    row = gerRandom小oordinate();\n    col = gerRandom小oordinate();\n  } while (board[row][col]);\n\n  board[row][col] = Math.random() < 0.9 ? 2 : 4;\n}\n\nfunction stepX(board, reverse = false) {\n  change = false;\n\n  board.forEach((item, i) => {\n    let row = item.filter((el) => el !== 0);\n\n    row = reverse ? row.reverse() : row;\n\n    row.forEach((el, j) => {\n      if (el === row[j + 1]) {\n        row[j] *= 2;\n        score += row[j];\n        elementScore.innerText = score;\n        row[j + 1] = 0;\n      }\n    });\n\n    row = row.filter((el) => el !== 0);\n    row = [...row, 0, 0, 0, 0];\n    row.length = 4;\n    row = reverse ? row.reverse() : row;\n\n    if (row.toString() !== item.toString()) {\n      board[i] = row;\n      change = true;\n    }\n  });\n\n  return board;\n}\n\nfunction stepY(board, reverse = false) {\n  let rotatedBoard = board.map((el, i) => el.map((item, j) => board[j][3 - i]));\n\n  rotatedBoard = stepX(rotatedBoard, reverse);\n\n  rotatedBoard.forEach((element, i) => {\n    element.forEach((item, j) => {\n      board[i][j] = rotatedBoard[3 - j][i];\n    });\n  });\n\n  return board;\n}\n\nfunction nextCell(board) {\n  if (change) {\n    addCell(board);\n    setTimeout(() => fillGameField(board), 200);\n  }\n}\n\nconst keyPress = (e) => {\n  e.preventDefault();\n\n  switch (e.code) {\n    case 'ArrowLeft':\n      fillGameField(stepX(gameField));\n      nextCell(gameField);\n      break;\n    case 'ArrowRight':\n      fillGameField(stepX(gameField, true));\n      nextCell(gameField);\n      break;\n    case 'ArrowUp':\n      fillGameField(stepY(gameField));\n      nextCell(gameField);\n      break;\n    case 'ArrowDown':\n      fillGameField(stepY(gameField, true));\n      nextCell(gameField);\n      break;\n    default:\n  }\n};\n\nconst touchEnd = (e) => {\n  if (startX && startY) {\n    const touchEndX = e.changedTouches[0].clientX;\n    const deltaX = touchEndX - startX;\n\n    const touchEndY = e.changedTouches[0].clientY;\n    const deltaY = touchEndY - startY;\n\n    if (Math.abs(deltaX) > 50) {\n      if (deltaX > 0) {\n        fillGameField(stepX(gameField, true));\n        nextCell(gameField);\n      } else {\n        fillGameField(stepX(gameField));\n        nextCell(gameField);\n      }\n\n      // startX = null;\n    }\n\n    if (Math.abs(deltaY) > 50) {\n      if (deltaY > 0) {\n        fillGameField(stepY(gameField, true));\n        nextCell(gameField);\n      } else {\n        fillGameField(stepY(gameField));\n        nextCell(gameField);\n      }\n\n      // startY = null;\n    }\n  }\n};\n\nbutton.addEventListener('click', () => {\n  if (button.classList.contains('start')) {\n    button.textContent = 'Restart';\n    button.className = 'button restart';\n    startMessages.hidden = true;\n  } else {\n    score = 0;\n    elementScore.innerText = score;\n    loseMessages.classList.add('hidden');\n    document.removeEventListener('keydown', keyPress);\n  }\n\n  gameField = [\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n  ];\n\n  addCell(gameField);\n  addCell(gameField);\n  fillGameField(gameField);\n\n  document.addEventListener('keydown', keyPress);\n\n  swipeArea.addEventListener('touchstart', (e) => {\n    startX = e.touches[0].clientX;\n    startY = e.touches[0].clientY;\n  });\n\n  swipeArea.addEventListener('touchmove', (e) => {\n    e.preventDefault();\n  });\n\n  swipeArea.addEventListener('touchend', touchEnd,);\n});\n"]}